import{m as I}from"./assets/module.esm-94724523.js";import{t as l,b as n}from"./assets/buffer-5b356251.js";document.addEventListener("alpine:init",()=>{I.data("webAuthnAuthenticate",function(){const{authenticatorDataInput:f,authnSelectForm:r,clientDataJSONInput:p,credentialIdInput:d,errorInput:s,signatureInput:h,userHandleInput:m,webAuthnForm:i}=this.$refs,{challenge:A,createTimeout:o,isUserIdentified:w,rpId:y,unsupportedBrowserText:b,userVerification:u}=this.$store.webAuthnAuthenticate,c=a=>{if(!window.PublicKeyCredential){s.value=b,i.submit();return}const t={challenge:l(n.parse(A,{loose:!0})),rpId:y};a.length&&(t.allowCredentials=a),parseInt(o)!==0&&(t.timeout=parseInt(o)*1e3),u!=="not specified"&&(t.userVerification=u),navigator.credentials.get({publicKey:t}).then(e=>{e instanceof PublicKeyCredential&&e.response instanceof AuthenticatorAssertionResponse&&(window.result=e,f.value=n.stringify(new Uint8Array(e.response.authenticatorData),{pad:!1}),p.value=n.stringify(new Uint8Array(e.response.clientDataJSON),{pad:!1}),h.value=n.stringify(new Uint8Array(e.response.signature),{pad:!1}),d.value=e.id,e.response.userHandle&&(m.value=n.stringify(new Uint8Array(e.response.userHandle),{pad:!1})),i.submit())}).catch(e=>{s.value=e,i.submit()})},g=()=>{const a=[];if(r){const t=Array.from(r.elements);t.length&&t.forEach(e=>{e instanceof HTMLInputElement&&a.push({id:l(n.parse(e.value,{loose:!0})),type:"public-key"})})}c(a)};return{webAuthnAuthenticate:()=>{if(!w){c([]);return}g()}}})});
